# 에러율 목표 및 모니터링 가이드

**프로젝트 코드**: ATCMP-2026  
**작성일**: 2025-01-27  
**버전**: 1.0

---

## 📋 개요

이 문서는 AT-CMP 프로젝트의 에러율 목표 및 모니터링 방법을 정의합니다. 시스템의 안정성을 보장하기 위해 에러율을 측정하고 목표를 설정합니다.

---

## 🎯 에러율 목표

### 전체 목표

- **전체 에러율**: < 0.5%
- **치명적 에러율**: < 0.1%
- **API 에러율**: < 0.5%
- **프론트엔드 에러율**: < 0.3%

### 계산 방법

```
에러율 (%) = (에러 발생 횟수 / 전체 요청 수) × 100

예시:
- 전체 요청 수: 100,000
- 에러 발생 횟수: 400
- 에러율: (400 / 100,000) × 100 = 0.4% ✅
```

### 에러 분류

#### P0 (치명적)

**정의**:
- 전체 서비스 다운
- 데이터 손실
- 보안 취약점

**목표 에러율**: < 0.01%

**예시**:
- 500 Internal Server Error (심각한 경우)
- 데이터베이스 연결 실패
- 인증 시스템 장애

#### P1 (높음)

**정의**:
- 핵심 기능 불가
- 사용자 데이터 접근 불가
- 주요 API 실패

**목표 에러율**: < 0.1%

**예시**:
- 500 Internal Server Error (일반)
- API 엔드포인트 실패
- 중요한 기능 오류

#### P2 (중간)

**정의**:
- 일부 기능 불가
- 성능 저하
- 사용자 경험 저하

**목표 에러율**: < 0.3%

**예시**:
- 400 Bad Request
- 404 Not Found (예상치 못한)
- 폼 유효성 검사 실패

#### P3 (낮음)

**정의**:
- 사소한 문제
- UI 버그
- 사용자 경험 미미한 영향

**목표 에러율**: < 0.5%

**예시**:
- 404 Not Found (예상된)
- 스타일링 문제
- 부가 기능 오류

---

## 📊 에러율 측정

### 측정 범위

**포함 항목**:
- API 에러 (5xx, 4xx)
- 프론트엔드 에러 (JavaScript 에러)
- 데이터베이스 에러
- 네트워크 에러

**제외 항목**:
- 예상된 404 에러 (존재하지 않는 리소스)
- 사용자 취소 요청
- 타임아웃으로 인한 정상 종료

### Sentry를 통한 에러 추적

**현재 설정**:
- 클라이언트: `sentry.client.config.ts`
- 서버: `sentry.server.config.ts`
- Edge: `sentry.edge.config.ts`

**자동 수집**:
- JavaScript 에러
- API 에러
- 미처리 예외
- Promise rejection

**에러율 계산**:
```
에러율 = (Sentry 에러 수 / 전체 요청 수) × 100
```

### API 에러율 측정

**측정 방법**:
```typescript
// api-performance.ts에서 자동 측정
if (status >= 400) {
  // 에러로 기록
  console.error(`[API Error] ${method} ${endpoint}: ${status}`);
}
```

**에러율 계산**:
```
API 에러율 = (HTTP 4xx/5xx 수 / 전체 API 요청 수) × 100
```

### 프론트엔드 에러율 측정

**측정 방법**:
- Sentry에서 자동 수집
- JavaScript 에러 추적
- React 에러 경계 활용

**에러율 계산**:
```
프론트엔드 에러율 = (JavaScript 에러 수 / 페이지 뷰 수) × 100
```

---

## 📈 에러율 모니터링

### Sentry Dashboard

**확인 방법**:
1. Sentry Dashboard → Issues
2. 에러 발생 빈도 확인
3. 에러율 트렌드 확인

**메트릭**:
- 에러 발생 횟수
- 에러율 (시간대별)
- 에러 해결 시간
- 사용자 영향 범위

### Vercel Analytics

**확인 방법**:
1. Vercel Dashboard → Analytics → Errors
2. 에러 통계 확인
3. 에러 트렌드 확인

**메트릭**:
- 에러 발생 횟수
- 에러율
- 페이지별 에러율

### 커스텀 모니터링

**에러율 추적**:
```typescript
// 에러 발생 시 자동 기록
// Sentry에서 자동 수집 및 집계
```

---

## 🚨 에러율 알림 설정

### 에러율 임계값

**경고 알림**:
- 전체 에러율 > 0.3%
- API 에러율 > 0.3%
- 프론트엔드 에러율 > 0.2%

**긴급 알림**:
- 전체 에러율 > 0.5%
- API 에러율 > 0.5%
- 치명적 에러 발생

### Sentry 알림 설정

**설정 방법**:
1. Sentry Dashboard → Settings → Alerts
2. New Alert Rule 클릭
3. 조건 설정:
   - Alert Type: Issue Alert
   - Conditions: 에러 발생 횟수 > 임계값
   - Actions: Slack #alerts 채널

**알림 규칙 예시**:
- 1시간에 10개 이상의 에러 발생
- 새로운 에러 타입 발생
- 에러율 > 0.5%

**알림 예시**:
```
🚨 [Error Rate] 에러율 임계값 초과

현재 에러율: 0.6% (목표: 0.5%)
에러 발생 횟수: 60 (1시간)
치명적 에러: 5건
링크: {sentry_url}
```

---

## 📊 에러율 리포트

### 일일 리포트

**포함 내용**:
- 일일 에러 발생 횟수
- 에러율 통계
- 새로운 에러 타입
- 해결된 에러

**생성 방법**:
1. Sentry Dashboard → Reports
2. 일일 리포트 생성
3. 팀에 공유

### 주간 리포트

**포함 내용**:
- 주간 에러율 통계
- 목표 달성 여부
- 에러 트렌드 분석
- 개선 사항 및 계획

**생성 방법**:
1. Sentry Dashboard → Reports
2. 주간 리포트 생성
3. 팀 회의에서 리뷰

---

## 🔧 에러율 개선 전략

### 예방 조치

1. **에러 처리 강화**:
   - 모든 API에 에러 핸들러 추가
   - 프론트엔드 에러 경계 설정
   - 예외 처리 패턴 통일

2. **테스트 강화**:
   - 단위 테스트 커버리지 향상
   - 통합 테스트 추가
   - E2E 테스트 추가

3. **코드 리뷰 강화**:
   - 에러 처리 코드 검토
   - 예외 상황 고려
   - 방어적 프로그래밍

4. **모니터링 강화**:
   - 실시간 에러 알림
   - 에러 트렌드 분석
   - 예측 모니터링

### 에러 해결 프로세스

1. **에러 발견**:
   - Sentry 알림 수신
   - 에러 상세 확인
   - 영향 범위 파악

2. **우선순위 결정**:
   - P0: 즉시 수정
   - P1: 24시간 내 수정
   - P2: 1주일 내 수정
   - P3: 계획적으로 수정

3. **에러 해결**:
   - 원인 분석
   - 수정 작업
   - 테스트 및 배포

4. **사후 조치**:
   - 에러 리포트 작성
   - 재발 방지 조치
   - 개선 사항 문서화

---

## ✅ 체크리스트

### 초기 설정
- [ ] Sentry 에러 모니터링 확인
- [ ] 에러율 측정 설정 확인
- [ ] 알림 규칙 설정 확인
- [ ] 에러 분류 기준 정의

### 정기 확인
- [ ] 일일 에러율 확인
- [ ] 주간 에러 리포트 검토
- [ ] 에러 해결 프로세스 준수
- [ ] 목표 달성 여부 확인

---

## 📚 참고 자료

- [Sentry 에러 모니터링 문서](https://docs.sentry.io/product/issues/)
- [에러 모니터링 설정 가이드](./error-monitoring-guide.md)
- [알림 설정 가이드](./alert-configuration.md)
- [Sentry 설정 파일](../web/sentry.client.config.ts)

---

**마지막 업데이트**: 2025-01-27  
**다음 검토일**: 2025-02-03

