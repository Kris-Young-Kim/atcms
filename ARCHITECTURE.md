# ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

**í”„ë¡œì íŠ¸ ì½”ë“œ**: ATCMP-2026  
**ì‘ì„±ì¼**: 2025-11-01  
**ë²„ì „**: 1.0

---

## ğŸ“‹ ê°œìš”

AT-CMPëŠ” Next.js 16 ê¸°ë°˜ì˜ í’€ìŠ¤íƒ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì™€ ì„œë²„ ì‚¬ì´ë“œê°€ ëª¨ë‘ Next.jsì—ì„œ ì²˜ë¦¬ë˜ë©°, ë°±ì—”ë“œë¡œ Supabaseë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      í´ë¼ì´ì–¸íŠ¸ (Browser)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           Next.js App Router (React)                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   Pages      â”‚  â”‚  Components  â”‚  â”‚   Hooks      â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ HTTP/HTTPS
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Next.js Server (Vercel)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              API Routes (/api/*)                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Auth        â”‚  â”‚  Validation  â”‚  â”‚  Audit Log   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ (Clerk)      â”‚  â”‚   (Zod)      â”‚  â”‚              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ Supabase JS Client
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Supabase Platform                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL Database                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   CMS       â”‚  â”‚    ERM       â”‚  â”‚   Audit      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   Tables    â”‚  â”‚   Tables     â”‚  â”‚   Logs       â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Storage (File Attachments)                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   Images     â”‚  â”‚     PDFs     â”‚  â”‚  Documents   â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ

- **Framework**: Next.js 16 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Fonts**: Geist Sans, Geist Mono
- **State Management**: React Hooks (useState, useEffect ë“±)
- **Forms**: React Hook Form (ì¶”ì •, í˜„ì¬ëŠ” ì§ì ‘ êµ¬í˜„)

### ë°±ì—”ë“œ

- **Runtime**: Node.js (Vercel Serverless Functions)
- **Database**: PostgreSQL (Supabase)
- **ORM/Query Builder**: Supabase JS Client
- **Authentication**: Clerk
- **File Storage**: Supabase Storage

### ì¸í”„ë¼

- **Hosting**: Vercel
- **Database Hosting**: Supabase
- **Monitoring**: Sentry (ì¤€ë¹„ ì¤‘)
- **CI/CD**: GitHub Actions

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/             # ì¸ì¦ ê´€ë ¨ í˜ì´ì§€ ê·¸ë£¹
â”‚   â”‚   â”‚   â”œâ”€â”€ sign-in/
â”‚   â”‚   â”‚   â””â”€â”€ sign-up/
â”‚   â”‚   â”œâ”€â”€ (dashboard)/        # ëŒ€ì‹œë³´ë“œ ê´€ë ¨ í˜ì´ì§€ ê·¸ë£¹
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/      # ëŒ€ì‹œë³´ë“œ í™ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ clients/       # ëŒ€ìƒì ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ equipment/     # ê¸°ê¸° ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ rentals/       # ëŒ€ì—¬ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ api/               # API Routes
â”‚   â”‚   â”‚   â”œâ”€â”€ clients/       # ëŒ€ìƒì API
â”‚   â”‚   â”‚   â”œâ”€â”€ equipment/     # ê¸°ê¸° API
â”‚   â”‚   â”‚   â”œâ”€â”€ rentals/       # ëŒ€ì—¬ API
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/     # ëŒ€ì‹œë³´ë“œ API
â”‚   â”‚   â”‚   â””â”€â”€ storage/       # íŒŒì¼ ì—…ë¡œë“œ API
â”‚   â”‚   â”œâ”€â”€ layout.tsx         # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”‚   â”œâ”€â”€ providers.tsx      # ê¸€ë¡œë²Œ Provider
â”‚   â”‚   â””â”€â”€ page.tsx           # ë£¨íŠ¸ í˜ì´ì§€
â”‚   â”‚
â”‚   â”œâ”€â”€ components/            # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ auth/              # ì¸ì¦ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ clients/           # ëŒ€ìƒì ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ equipment/         # ê¸°ê¸° ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ rentals/           # ëŒ€ì—¬ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ layout/            # ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ ui/                # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                   # ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ logger/            # ê°ì‚¬ ë¡œê·¸
â”‚   â”‚   â”œâ”€â”€ supabase/          # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ utils/             # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”‚   â””â”€â”€ validations/       # Zod ìŠ¤í‚¤ë§ˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                # ì„¤ì • íŒŒì¼
â”‚   â”‚   â””â”€â”€ env.ts             # í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
â”‚   â”‚
â”‚   â””â”€â”€ middleware.ts          # Next.js ë¯¸ë“¤ì›¨ì–´
â”‚
â”œâ”€â”€ public/                    # ì •ì  íŒŒì¼
â”œâ”€â”€ supabase/                  # Supabase ì„¤ì •
â”‚   â””â”€â”€ migrations/            # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ next.config.ts             # Next.js ì„¤ì •
â””â”€â”€ package.json               # ì˜ì¡´ì„± ê´€ë¦¬
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### 1. ì¸ì¦ íë¦„

```
ì‚¬ìš©ì ë¡œê·¸ì¸ ìš”ì²­
    â†“
Clerk Authentication
    â†“
ì„¸ì…˜ í† í° ë°œê¸‰
    â†“
Next.js Middleware (ì¸ì¦ í™•ì¸)
    â†“
API Route ë˜ëŠ” í˜ì´ì§€ ì ‘ê·¼
```

### 2. API ìš”ì²­ íë¦„

```
Client Component
    â†“
API Route Handler
    â†“
1. ì¸ì¦ í™•ì¸ (Clerk auth())
    â†“
2. ì—­í•  ê¶Œí•œ í™•ì¸ (sessionClaims)
    â†“
3. ì…ë ¥ ê²€ì¦ (Zod schema)
    â†“
4. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
    â†“
5. Supabase ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼
    â†“
6. ê°ì‚¬ ë¡œê·¸ ê¸°ë¡ (auditLogger)
    â†“
7. ì‘ë‹µ ë°˜í™˜
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ íŒ¨í„´

```
API Route
    â†“
createSupabaseServerClient()
    â†“
Supabase JS Client
    â†“
PostgreSQL Database
```

---

## ğŸ” ë³´ì•ˆ ì•„í‚¤í…ì²˜

### ì¸ì¦ (Authentication)

- **Clerk**: ì‚¬ìš©ì ì¸ì¦ ë° ì„¸ì…˜ ê´€ë¦¬
- **Middleware**: ëª¨ë“  ìš”ì²­ì— ëŒ€í•œ ì¸ì¦ í™•ì¸
- **Public Routes**: `/`, `/sign-in`, `/sign-up`ë§Œ ê³µê°œ ì ‘ê·¼ í—ˆìš©

### ì¸ê°€ (Authorization)

- **ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)**: Clerkì˜ `sessionClaims.metadata.role` ì‚¬ìš©
- **ì—­í• **: `admin`, `leader`, `specialist`, `socialWorker`, `technician`
- **ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ê²€ì¦**: API Routeì—ì„œ ì—­í•  í™•ì¸ (RLS ë¯¸ì‚¬ìš©)

### ì…ë ¥ ê²€ì¦

- **Zod Schema**: ëª¨ë“  API ì…ë ¥ì— Zod ê²€ì¦ ì ìš©
- **íƒ€ì… ì•ˆì •ì„±**: TypeScriptë¡œ ì»´íŒŒì¼ íƒ€ì„ ê²€ì¦

### ê°ì‚¬ ë¡œê¹…

- **auditLogger**: ëª¨ë“  ì¤‘ìš”í•œ ì‘ì—… ê¸°ë¡
- **ì €ì¥ì†Œ**: Supabase `audit_logs` í…Œì´ë¸”
- **ë¡œê·¸ ë ˆë²¨**: `info`, `error`
- **ë¡œê¹… ëŒ€ìƒ**: CRUD ì‘ì—…, ìƒíƒœ ë³€ê²½, ê¶Œí•œ ìœ„ë°˜ ì‹œë„

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜

### ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ íŒ¨í„´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      API Route Handler                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  createSupabaseServerClient()           â”‚
â”‚  (ì„œë²„ ì‚¬ì´ë“œ í´ë¼ì´ì–¸íŠ¸)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Supabase JS Client                  â”‚
â”‚  - ì¿¼ë¦¬ ë¹Œë” (chainable API)             â”‚
â”‚  - ìë™ íƒ€ì… ì¶”ë¡                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      PostgreSQL Database                 â”‚
â”‚  (Supabase í˜¸ìŠ¤íŒ…)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í´ë¼ì´ì–¸íŠ¸ íƒ€ì…

1. **Browser Client** (`createSupabaseBrowserClient`)
   - í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©
   - ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ ì‹¤í–‰

2. **Server Client** (`createSupabaseServerClient`)
   - API Route ë° Server Componentì—ì„œ ì‚¬ìš©
   - ì„œë²„ ì‚¬ì´ë“œì—ì„œ ì‹¤í–‰
   - ì¿ í‚¤ ê¸°ë°˜ ì¸ì¦ ì²˜ë¦¬

3. **Service Role Client** (`createSupabaseServiceRoleClient`)
   - ê´€ë¦¬ì ì‘ì—…ì— ì‚¬ìš©
   - RLS ìš°íšŒ (í˜„ì¬ ë¯¸ì‚¬ìš©)

---

## ğŸ¨ ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

### ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ êµ¬ì¡°

```
AppLayout (ìµœìƒìœ„ ë ˆì´ì•„ì›ƒ)
â”œâ”€â”€ Header (í—¤ë”)
â”œâ”€â”€ Sidebar (ì‚¬ì´ë“œë°”)
â””â”€â”€ Page Content
    â”œâ”€â”€ Dashboard Components
    â”œâ”€â”€ Client Components
    â”œâ”€â”€ Equipment Components
    â””â”€â”€ Rental Components
```

### ì»´í¬ë„ŒíŠ¸ ë¶„ë¥˜

1. **Layout Components** (`components/layout/`)
   - `AppLayout`: ì „ì²´ ì•± ë ˆì´ì•„ì›ƒ
   - `Header`: ìƒë‹¨ í—¤ë”
   - `Sidebar`: ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜

2. **Feature Components** (`components/clients/`, `components/equipment/`, `components/rentals/`)
   - ê° ê¸°ëŠ¥ ëª¨ë“ˆë³„ ì»´í¬ë„ŒíŠ¸
   - í¼, í…Œì´ë¸”, íƒ€ì„ë¼ì¸ ë“±

3. **UI Components** (`components/ui/`)
   - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê³µí†µ ì»´í¬ë„ŒíŠ¸
   - `FileUpload`, `Toast` ë“±

4. **Auth Components** (`components/auth/`)
   - ì¸ì¦ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
   - `ProtectedRoute` ë“±

---

## ğŸ”Œ API ì•„í‚¤í…ì²˜

### API Route êµ¬ì¡°

```
/api/
â”œâ”€â”€ clients/              # ëŒ€ìƒì API
â”‚   â”œâ”€â”€ route.ts         # GET, POST
â”‚   â””â”€â”€ [id]/
â”‚       â”œâ”€â”€ route.ts     # GET, PUT, DELETE
â”‚       â”œâ”€â”€ consultations/
â”‚       â”‚   â”œâ”€â”€ route.ts # GET, POST
â”‚       â”‚   â””â”€â”€ [consultationId]/route.ts # GET, PUT, DELETE
â”‚       â””â”€â”€ assessments/
â”‚           â”œâ”€â”€ route.ts # GET, POST
â”‚           â””â”€â”€ [assessmentId]/route.ts # GET, PUT, DELETE
â”‚
â”œâ”€â”€ equipment/            # ê¸°ê¸° API
â”‚   â”œâ”€â”€ route.ts         # GET, POST
â”‚   â””â”€â”€ [id]/
â”‚       â”œâ”€â”€ route.ts     # GET, PUT
â”‚       â”œâ”€â”€ status/route.ts # PATCH
â”‚       â”œâ”€â”€ quantity/route.ts # PATCH
â”‚       â””â”€â”€ maintenance-notes/route.ts # GET, POST
â”‚
â”œâ”€â”€ rentals/             # ëŒ€ì—¬ API
â”‚   â”œâ”€â”€ route.ts         # GET, POST
â”‚   â””â”€â”€ [id]/
â”‚       â”œâ”€â”€ route.ts     # GET
â”‚       â””â”€â”€ return/route.ts # PATCH
â”‚
â”œâ”€â”€ dashboard/           # ëŒ€ì‹œë³´ë“œ API
â”‚   â””â”€â”€ stats/route.ts   # GET
â”‚
â””â”€â”€ storage/             # íŒŒì¼ ìŠ¤í† ë¦¬ì§€ API
    â””â”€â”€ upload/route.ts  # POST, DELETE
```

### API ê³µí†µ ì²˜ë¦¬ íë¦„

1. **ì¸ì¦ í™•ì¸**: `auth()` í˜¸ì¶œ
2. **ê¶Œí•œ í™•ì¸**: `sessionClaims.metadata.role` í™•ì¸
3. **ì…ë ¥ ê²€ì¦**: Zod schemaë¡œ ê²€ì¦
4. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**: ë°ì´í„° ì²˜ë¦¬
5. **ê°ì‚¬ ë¡œê·¸**: `auditLogger`ë¡œ ê¸°ë¡
6. **ì‘ë‹µ ë°˜í™˜**: JSON í˜•ì‹

---

## ğŸ”„ ìƒíƒœ ê´€ë¦¬

í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” **ì„œë²„ ìƒíƒœ ì¤‘ì‹¬** ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

- **ì„œë²„ ìƒíƒœ**: Supabaseì—ì„œ ì§ì ‘ ì¡°íšŒ
- **í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ**: React `useState`, `useEffect` ì‚¬ìš©
- **ì „ì—­ ìƒíƒœ**: í•„ìš”ì‹œ React Context ì‚¬ìš© (í˜„ì¬ ë¯¸ì‚¬ìš©)

**í–¥í›„ ê³„íš**: React Query ë˜ëŠ” SWR ë„ì… ê³ ë ¤

---

## ğŸ“¦ ë¹Œë“œ ë° ë°°í¬

### ë¹Œë“œ í”„ë¡œì„¸ìŠ¤

```
Source Code
    â†“
TypeScript Compilation
    â†“
Next.js Build (App Router)
    â†“
Static Assets + Server Functions
    â†“
Vercel Deployment
```

### ë°°í¬ í™˜ê²½

- **Development**: ë¡œì»¬ ê°œë°œ (`pnpm dev`)
- **Staging**: `develop` ë¸Œëœì¹˜ ìë™ ë°°í¬ (Vercel Preview)
- **Production**: `main` ë¸Œëœì¹˜ ë°°í¬ (ìˆ˜ë™ ìŠ¹ì¸ í•„ìš”)

---

## ğŸ” ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### ê°ì‚¬ ë¡œê¹…

- **êµ¬í˜„**: `lib/logger/auditLogger.ts`
- **ì €ì¥ì†Œ**: Supabase `audit_logs` í…Œì´ë¸”
- **ì¶”ì  í•­ëª©**: CRUD ì‘ì—…, ìƒíƒœ ë³€ê²½, ë³´ì•ˆ ì´ë²¤íŠ¸

### ì—ëŸ¬ ëª¨ë‹ˆí„°ë§

- **Sentry**: ì¤€ë¹„ ì¤‘ (Next.js 16 ì§€ì› ëŒ€ê¸°)
- **í˜„ì¬**: ì½˜ì†” ë¡œê·¸ ë° ê°ì‚¬ ë¡œê·¸

---

## ğŸ”® í–¥í›„ í™•ì¥ ê³„íš

### Phase 2+

- **ìƒíƒœ ê´€ë¦¬**: React Query ë„ì…
- **ì‹¤ì‹œê°„**: Supabase Realtime êµ¬ë…
- **ìºì‹±**: Next.js ìºì‹± ì „ëµ ê°•í™”
- **ì„±ëŠ¥**: ì´ë¯¸ì§€ ìµœì í™”, ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
- **í…ŒìŠ¤íŠ¸**: E2E í…ŒìŠ¤íŠ¸ ìë™í™” (Playwright)

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](./DATABASE_SCHEMA.md)
- [API ë¬¸ì„œ](./API_DOCS.md)
- [ë°°í¬ ê°€ì´ë“œ](./DEPLOYMENT.md)
- [ê°œë°œ ê°€ì´ë“œ](./DEVELOPMENT.md)

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-01  
**ë‹¤ìŒ ê²€í† ì¼**: 2026-02-01

